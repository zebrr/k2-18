# cli_itext2kg.md

## Status: READY

CLI —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π –∏–∑ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–∞–π—Å—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ LLM —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ previous_response_id. –í–∫–ª—é—á–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

## CLI Interface

**–ó–∞–ø—É—Å–∫:**
```bash
python -m src.itext2kg
```

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `/data/staging/*.slice.json` - —Å–ª–∞–π—Å—ã –æ—Ç slicer.py

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `/data/out/ConceptDictionary.json` - —Å–ª–æ–≤–∞—Ä—å –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
- `/data/out/LearningChunkGraph_raw.json` - –≥—Ä–∞—Ñ –∑–Ω–∞–Ω–∏–π
- `/logs/itext2kg_YYYY-MM-DD_HH-MM-SS.log` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
- `/logs/{slice_id}_bad.json` - –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã LLM (–ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)
- `/logs/*_temp_*.json` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–º–ø—ã (–ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö)

**–ö–æ–¥—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**
- 0 (SUCCESS) - —É—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- 1 (CONFIG_ERROR) - –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- 2 (INPUT_ERROR) - –Ω–µ—Ç —Å–ª–∞–π—Å–æ–≤ –≤ staging
- 3 (RUNTIME_ERROR) - –≤—Å–µ —Å–ª–∞–π—Å—ã failed –∏–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
- 4 (API_LIMIT_ERROR) - –∏—Å—á–µ—Ä–ø–∞–Ω—ã –ª–∏–º–∏—Ç—ã API
- 5 (IO_ERROR) - –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤

## Core Algorithm

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–∞–π—Å–æ–≤** –∏–∑ staging –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º previous_response_id:
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (ConceptDictionary + Slice)
   - –í—ã–∑–æ–≤ LLM —á–µ—Ä–µ–∑ Responses API
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞
   - Repair-reprompt –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (1 –ø–æ–ø—ã—Ç–∫–∞)
   - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
   - **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–ª–∞–π—Å–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ MENTIONS edges –¥–ª—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö Chunks
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–±–æ–µ–≤** —Å graceful degradation:
   - –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–±–æ—è—Ö
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–æ–≤ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
4. **–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–¥–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤)
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** –≤ output

## Terminal Output

–£—Ç–∏–ª–∏—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º:
```
[HH:MM:SS] TAG      | –î–∞–Ω–Ω—ã–µ
```

### –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**START - –Ω–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
[10:30:00] START    | 157 slices | model=o4-mini-2025-04-16 | tpm=100k
```

**SLICE - —É—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–∞–π—Å–∞:**
```
[10:30:05] SLICE    | ‚úÖ 001/157 | tokens_used=12.35k | tokens_current=1.23k | 5s | concepts=23 | nodes=156 | edges=287
[10:30:12] SLICE    | ‚úÖ 002/157 | tokens_used=112.34k | tokens_current=11.23k incl. reasoning=567 | 8s | concepts=25 | nodes=163 | edges=301
```

**REPAIR - –ø–æ–ø—ã—Ç–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
```
[10:30:45] REPAIR   | üîß Attempting to fix JSON validation error...
[10:30:45] REPAIR   | üìù Adding clarification to prompt and retrying...
[10:30:50] REPAIR   | ‚úÖ JSON validation fixed successfully!
```

**ERROR - –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
[10:30:45] ERROR    | ‚ùå 042/157 | slice_042 | JSON validation failed after repair
[10:30:45] ERROR    | ‚ùå Incremental validation failed for slice_042
[10:30:45] ERROR    | üìã Error: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID —É–∑–ª–∞ (Assessment): algo101:q:1234:0...
[10:31:02] ERROR    | ‚ö†Ô∏è RateLimitError | waiting for retry...
[10:31:15] ERROR    | ‚ö†Ô∏è APIError | slice slice_055
```

**FAILED - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:**
```
[10:45:30] FAILED   | ‚ùå All slices failed processing
[10:45:30] FAILED   | ‚ùå Critical error: Connection timeout...
[10:45:30] FAILED   | ‚ùå Validation failed: Invalid graph structure...
```

**SAVING - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:**
```
[10:45:30] SAVING   | üíæ Attempting to save empty structures...
[10:45:30] SAVING   | üíæ Emergency dump of current state...
[10:45:30] SAVING   | üíæ Attempting to save partial results...
```

**INFO - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
[10:45:31] INFO     | Check /logs/ for temporary files and diagnostics
```

**SUCCESS - —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:**
```
[10:45:30] SUCCESS  | ‚úÖ Results saved to /data/out/
                    | - ConceptDictionary.json
                    | - LearningChunkGraph_raw.json
```

**END - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã:**
```
[10:45:30] END      | Done | slices=157 | time=15m 30s
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª—ã

–í —Ñ–∞–π–ª–∞—Ö –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JSON Lines —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:
- **INFO —É—Ä–æ–≤–µ–Ω—å**: –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **DEBUG —É—Ä–æ–≤–µ–Ω—å**: –ø–æ–ª–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –∏ –æ—Ç–≤–µ—Ç—ã LLM (–ø—Ä–∏ log_level=debug)
- **ERROR —É—Ä–æ–≤–µ–Ω—å**: –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ API

–û—à–∏–±–∫–∏ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π logger:
```
[10:30:00] ERROR    | No slice files found in staging directory
```

## Public Classes

### ProcessingStats
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–∞–π—Å–æ–≤.
- **Attributes**: total_slices, processed_slices, failed_slices, total_concepts, total_nodes, total_edges, total_tokens_used, start_time

### SliceData
–î–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ —Å–ª–∞–π—Å–∞.
- **Attributes**: id, order, source_file, slug, text, slice_token_start, slice_token_end

### SliceProcessor
–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **__init__(config)** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- **run()** - –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## Internal Methods

### SliceProcessor._format_tokens(tokens)
–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥.
- **Input**: tokens - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤
- **Returns**: —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "123", "45.61k", "1.22M"
- **Features**:
  - –ß–∏—Å–ª–∞ < 1000: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ("123")
  - –¢—ã—Å—è—á–∏ (1K-999K): —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ "45.61k" —Å –¥–≤—É–º—è –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
  - –ú–∏–ª–ª–∏–æ–Ω—ã (1M+): —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ "1.22M" —Å –¥–≤—É–º—è –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

### SliceProcessor._process_chunk_nodes(new_nodes)
–û–±—Ä–∞–±–æ—Ç–∫–∞ —É–∑–ª–æ–≤ —Ç–∏–ø–∞ Chunk –∏ Assessment —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.
- **Input**: new_nodes - —Å–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö —É–∑–ª–æ–≤ –∏–∑ –ø–∞—Ç—á–∞
- **Returns**: —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –≥—Ä–∞—Ñ
- **Features**:
  - –î–ª—è Chunk: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–æ–≤—ã–π –¥–ª–∏–Ω–Ω–µ–µ
  - –î–ª—è Assessment: –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  - –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### SliceProcessor._validate_edges(edges)
–í–∞–ª–∏–¥–∞—Ü–∏—è —Ä—ë–±–µ—Ä —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —É–∑–ª–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.
- **Input**: edges - —Å–ø–∏—Å–æ–∫ —Ä—ë–±–µ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- **Returns**: —Å–ø–∏—Å–æ–∫ –≤–∞–ª–∏–¥–Ω—ã—Ö —Ä—ë–±–µ—Ä
- **Features**:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è source/target —É–∑–ª–æ–≤ (–≤–∫–ª—é—á–∞—è –∫–æ–Ω—Ü–µ–ø—Ç—ã –∏–∑ ConceptDictionary)
  - –û—Ç–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ PREREQUISITE self-loops
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Å–æ–≤ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0,1]
  - **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä—ë–±–µ—Ä**:
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ç–∏–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä—ë–±–µ—Ä –≤ –≥—Ä–∞—Ñ–µ
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ç—á–∞
    - –î—É–±–ª–∏–∫–∞—Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (source, target, type)
    - –í–µ—Å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞
  - –ë–∏—Ç—ã–µ —Ä—ë–±—Ä–∞ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è —Å WARNING –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
  - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è —Å INFO –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### SliceProcessor._save_bad_response(slice_id, original_response, error, repair_response=None)
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ LLM –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
- **Input**: slice_id, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏, repair –æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ –±—ã–ª)
- **Output**: —Ñ–∞–π–ª `/logs/{slice_id}_bad.json` —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### SliceProcessor._save_temp_dumps(reason)
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–æ–≤ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö.
- **Input**: reason - –ø—Ä–∏—á–∏–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (interrupted, validation_failed, io_error, all_failed, critical_error, validation_error_slice_{id})
- **Output**: 
  - ConceptDictionary_temp_{reason}_{timestamp}.json
  - LearningChunkGraph_temp_{reason}_{timestamp}.json
  - processing_stats_{reason}_{timestamp}.json

### SliceProcessor._process_single_slice(slice_file)
–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ —Å–ª–∞–π—Å–∞ —Å –ø–æ–ª–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.
- **Returns**: True –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, False –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
- **Features**: 
  - repair-reprompt –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º JSON
  - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bad responses
  - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—á–∞
  - graceful error handling

### SliceProcessor._add_mentions_edges(chunk_nodes)
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç MENTIONS edges –æ—Ç Chunks –∫ Concepts –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞.
- **Input**: chunk_nodes - —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ —Ç–∏–ø–∞ Chunk –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Returns**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö MENTIONS edges
- **Algorithm**:
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ Chunk –∏—â–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ –∏–∑ ConceptDictionary
  - –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ term.primary –∏ –≤—Å–µ–º term.aliases
  - **–ü—Ä–∞–≤–∏–ª–∞ –ø–æ–∏—Å–∫–∞**:
    - Full word matches only (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç regex `\b` –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤)
    - Case-insensitive (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
    - Exact forms only (–±–µ–∑ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–∏, "—Å—Ç–µ–∫–∏" ‚â† "—Å—Ç–µ–∫")
  - –ò–∑–±–µ–≥–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö MENTIONS edges
  - –í—Å–µ MENTIONS edges –∏–º–µ—é—Ç weight=1.0

### SliceProcessor._process_llm_response(response_text, slice_id)
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ LLM —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–æ–π –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.
- **Input**: response_text - —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç –æ—Ç LLM, slice_id - ID —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π—Å–∞
- **Returns**: (success, parsed_data) - —É—Å–ø–µ—Ö –∏ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ None
- **Features**:
  - **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ HTML –∞—Ç—Ä–∏–±—É—Ç–æ–≤**:
    - –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–∏–ø–∞ `href='\"url\"'` ‚Üí `href="url"`
    - –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–∏–ø–∞ `src="'url'"` ‚Üí `src="url"` 
    - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –æ—Ç–≤–µ—Ç–∞–º –ø–µ—Ä–µ–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º JSON
    - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã: href, src, target, action, name, frameborder, width, height, align
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∑–∞–º–µ–Ω—ã
  - –ü–∞—Ä—Å–∏–Ω–≥ –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ JSON
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ª–∏—á–∏–µ concepts_added –∏ chunk_graph_patch)
  - –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Å—Ö–µ–º–∞–º ConceptDictionary –∏ LearningChunkGraph
  - –ü—Ä–∏ –æ—à–∏–±–∫–µ –ª–æ–≥–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## Key Features

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ previous_response_id
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É —Å–ª–∞–π—Å–∞–º–∏ –¥–æ 128K —Ç–æ–∫–µ–Ω–æ–≤
- –ü—Ä–∏ retry –∏ repair –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ previous_response_id

### –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ConceptDictionary
- –ù–æ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π case-insensitive –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ aliases
- –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤:
  - –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ aliases —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π case-insensitive —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
  - Primary —Ç–µ—Ä–º–∏–Ω –∏ definition —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
  - –ù–æ–≤—ã–µ aliases –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏—Ö lowercase –≤–µ—Ä—Å–∏–∏ –µ—â–µ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ
- –°–æ–∑–¥–∞–Ω–∏–µ —É–∑–ª–æ–≤ —Ç–∏–ø–∞ Concept –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
- **Case-insensitive –ª–æ–≥–∏–∫–∞**:
  - –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ü–µ–ø—Ç–∞: —É–¥–∞–ª—è—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã aliases (–Ω–∞–ø—Ä–∏–º–µ—Ä, ["Stack", "stack"] ‚Üí ["Stack"])
  - –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ: –Ω–æ–≤—ã–µ aliases –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è case-insensitive –ø—Ä–æ—Ç–∏–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ alias —Å –µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç case-insensitive —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å aliases –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ü–µ–ø—Ç–∞, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ. LLM –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Ç–∏–ø–∞ ["Brute Force", "brute force"], –Ω–æ —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —É–∑–ª–æ–≤
- **Chunk —É–∑–ª—ã**: –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö ID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ç–µ–∫—Å—Ç–∞
- **Assessment —É–∑–ª—ã**: –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
- **Concept —É–∑–ª—ã**: –¥—É–±–ª–∏–∫–∞—Ç—ã –ù–ï –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç—Å—è (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –≤ dedup.py)
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Å–ª–∞–π—Å–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `validate_graph_invariants_intermediate()`:
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ID –¥–ª—è Chunk –∏ Assessment
  - –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ID –¥–ª—è Concept (–¥–æ–ø—É—Å—Ç–∏–º—ã –¥—É–±–ª–∏–∫–∞—Ç—ã)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≥—Ä–∞—Ñ–∞
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
  - –°–ª–∞–π—Å –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ failed
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Å–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–∞–π—Å–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä—ë–±–µ—Ä
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è source/target —É–∑–ª–æ–≤
- –û—Ç–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ PREREQUISITE self-loops
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Å–æ–≤ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0,1]
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä—ë–±–µ—Ä** (–¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å previous_response_id):
  - LLM –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å MENTIONS –¥–ª—è —É–∑–ª–æ–≤ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–ª–∞–π—Å–æ–≤
  - –í—Å–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Å—ã–ª–æ–∫ –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ç—ã –∏–∑ ConceptDictionary

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ MENTIONS edges
- –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ç—á–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â—É—Ç—Å—è —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –Ω–æ–≤—ã–µ Chunk —É–∑–ª—ã, —Ç–∞–∫ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
- –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Ç–µ—Ä–º–∞–º –∏–∑ ConceptDictionary (primary + aliases)
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ—Ç—É –≥—Ä–∞—Ñ–∞ –¥–∞–∂–µ –µ—Å–ª–∏ LLM –ø—Ä–æ–ø—É—Å—Ç–∏–ª –æ—á–µ–≤–∏–¥–Ω—ã–µ —Å–≤—è–∑–∏
- –ü—Ä–∏–º–µ—Ä:
  ```
  –ö–æ–Ω—Ü–µ–ø—Ç: {"primary": "–°—Ç–µ–∫", "aliases": ["stack", "LIFO"]}
  Chunk text: "–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–µ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è. Stack - —ç—Ç–æ LIFO —Å—Ç—Ä—É–∫—Ç—É—Ä–∞."
  –†–µ–∑—É–ª—å—Ç–∞—Ç: 1 MENTIONS edge (–≤—Å–µ —Ç—Ä–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤–µ–¥—É—Ç –∫ –æ–¥–Ω–æ–º—É –∫–æ–Ω—Ü–µ–ø—Ç—É)
  ```

### Error Recovery
- **Repair-reprompt**: –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º JSON –¥–µ–ª–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —É—Ç–æ—á–Ω–µ–Ω–∏–µ–º
  - –ú–µ—Ç–æ–¥ `repair_response()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π previous_response_id
  - –í repair –ø—Ä–æ–º–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –æ—à–∏–±–∫—É –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON
- **HTML attributes cleanup**: –ø–µ—Ä–µ–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º JSON –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–≤—ã—á–∫–∞–º–∏ –≤ HTML –∞—Ç—Ä–∏–±—É—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ LLM –∏–Ω–æ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–æ–∫ –∏–∑ —Å–ª–∞–π—Å–æ–≤
- **Graceful degradation**: –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–±–æ—è—Ö
- **Temporary dumps**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
- **Interrupt handling**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Ctrl+C —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## Configuration

–°–µ–∫—Ü–∏—è `[itext2kg]` –≤ config.toml:
- **model** - –º–æ–¥–µ–ª—å LLM (o4-mini-2025-04-16)
- **tpm_limit** - –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **tpm_safety_margin** - –∑–∞–ø–∞—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è TPM (0.15)
- **max_completion** - –º–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
- **log_level** - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (debug/info)
- **temperature** - –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- **reasoning_effort** - –¥–ª—è reasoning –º–æ–¥–µ–ª–µ–π
- **reasoning_summary** - —Ñ–æ—Ä–º–∞—Ç —Ä–µ–∑—é–º–µ –¥–ª—è reasoning –º–æ–¥–µ–ª–µ–π
- **timeout** - —Ç–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- **max_retries** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API

## Error Handling & Exit Codes

### Recoverable Errors
- **JSON validation errors** ‚Üí repair-reprompt (1 –ø–æ–ø—ã—Ç–∫–∞) ‚Üí bad response —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- **Incremental validation errors** ‚Üí —Å–ª–∞–π—Å –ø–æ–º–µ—á–∞–µ—Ç—Å—è failed ‚Üí –≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∞–º–ø ‚Üí –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
- **API errors** ‚Üí exponential backoff —á–µ—Ä–µ–∑ llm_client (20s ‚Üí 40s ‚Üí 80s...)
- **Rate limits** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ TPMBucket —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### Non-recoverable Errors
- **All slices failed** ‚Üí –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–º–ø—ã ‚Üí EXIT_RUNTIME_ERROR (3)
- **Configuration errors** ‚Üí EXIT_CONFIG_ERROR (1)
- **I/O errors** ‚Üí –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–º–ø—ã ‚Üí EXIT_IO_ERROR (5)

### Partial Failures
- –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∞–π—Å—ã —É—Å–ø–µ—à–Ω—ã
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ failure rate > 50%
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–∞—Ö

## Boundary Cases

- **–ü—É—Å—Ç–æ–π staging** ‚Üí EXIT_INPUT_ERROR (2)
- **–ë–∏—Ç—ã–π slice.json** ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–ø—É—Å–∫ —Å–ª–∞–π—Å–∞, –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
- **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π LLM –æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ repair** ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ logs/{slice_id}_bad.json
- **–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ Ctrl+C** ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–æ–≤ ‚Üí EXIT_RUNTIME_ERROR
- **Validation failed (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è)** ‚Üí –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–º–ø—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º validation_failed
- **Validation failed (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è)** ‚Üí –≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∞–º–ø –¥–ª—è —Å–ª–∞–π—Å–∞ ‚Üí —Å–ª–∞–π—Å failed
- **–í—ã—Å–æ–∫–∏–π failure rate** ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- **–î—É–±–ª–∏–∫–∞—Ç ID –∫–æ–Ω—Ü–µ–ø—Ç–∞** ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω, —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –≤ dedup.py
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ –æ—Ç LLM** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –≤ _validate_edges ‚Üí INFO –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ HTML –∞—Ç—Ä–∏–±—É—Ç—ã –≤ –æ—Ç–≤–µ—Ç–µ LLM** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ `='\"...\"'` ‚Üí —É—Å–ø–µ—à–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

## Output Validation

–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- `validate_json()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å—Ö–µ–º–∞–º ConceptDictionary –∏ LearningChunkGraph
- `validate_concept_dictionary_invariants()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å–ª–æ–≤–∞—Ä—è
- `validate_graph_invariants_intermediate()` - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤)

**–í–∞–∂–Ω–æ:** –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—É—é `validate_graph_invariants()`, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –º–æ–≥—É—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤ dedup.py.

## Output Format

**ConceptDictionary.json:**
```json
{
  "concepts": [
    {
      "concept_id": "slug:p:term",
      "term": {"primary": "–¢–µ—Ä–º–∏–Ω", "aliases": ["term", "—Å–∏–Ω–æ–Ω–∏–º"]},
      "definition": "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ç–∞"
    }
  ]
}
```

**LearningChunkGraph_raw.json:**
```json
{
  "nodes": [
    {
      "id": "slug:c:token_start",
      "type": "Chunk|Concept|Assessment",
      "text": "–¢–µ–∫—Å—Ç —É–∑–ª–∞",
      "local_start": 0,
      "difficulty": 1,
      "definition": "–î–ª—è —É–∑–ª–æ–≤ —Ç–∏–ø–∞ Concept"
    }
  ],
  "edges": [
    {
      "source": "node_id",
      "target": "node_id", 
      "type": "PREREQUISITE|MENTIONS|...",
      "weight": 0.8
    }
  ]
}
```

**Bad Response Format ({slice_id}_bad.json):**
```json
{
  "slice_id": "slice_001",
  "timestamp": "2024-01-15T10:30:00Z",
  "original_response": "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –æ—Ç–≤–µ—Ç LLM",
  "validation_error": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "repair_response": "–æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ repair (–µ—Å–ª–∏ –±—ã–ª)"
}
```

## Test Coverage

- **test_slice_processor**: 21 —Ç–µ—Å—Ç–æ–≤
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ –∏ —É–∑–ª–æ–≤
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä—ë–±–µ—Ä
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ LLM –æ—Ç–≤–µ—Ç–æ–≤
  - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ MENTIONS edges (5 —Ç–µ—Å—Ç–æ–≤)**
  
- **test_processing_flow**: 8 —Ç–µ—Å—Ç–æ–≤
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–∞–π—Å–æ–≤
  - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—á–µ–π
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bad responses
  - –£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ repair
  - –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω pipeline

- **test_itext2kg_error_handling**: 9 —Ç–µ—Å—Ç–æ–≤
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bad responses
  - –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–æ–≤
  - Repair-reprompt –º–µ—Ö–∞–Ω–∏–∑–º
  - Graceful degradation
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
  - –í—Å–µ –≤–∏–¥—ã —Å–±–æ–µ–≤

- **test_itext2kg_deduplication**: 11 —Ç–µ—Å—Ç–æ–≤
  - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —É–∑–ª–æ–≤ (Chunk/Assessment)
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è —Ç–µ–∫—Å—Ç–æ–≤
  - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
  - **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ä—ë–±–µ—Ä (4 —Ç–µ—Å—Ç–∞)**
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö MENTIONS
  - –°—Ü–µ–Ω–∞—Ä–∏–π —Å previous_response_id

## Dependencies
- **Standard Library**: json, logging, sys, time, pathlib, datetime, typing, dataclasses, re
- **External**: None (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç utils)
- **Internal**: utils.config, utils.exit_codes, utils.llm_client, utils.validation (–≤–∫–ª—é—á–∞—è validate_graph_invariants_intermediate), utils.console_encoding

## Performance Notes
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- TPM –∫–æ–Ω—Ç—Ä–æ–ª—å —á–µ—Ä–µ–∑ llm_client —Å safety margin
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON Lines —Ñ–æ—Ä–º–∞—Ç–µ
- –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- Checkpoint –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–ª–∞–π—Å–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ repair –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é previous_response_id
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead (< 50ms –Ω–∞ —Å–ª–∞–π—Å)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ä—ë–±–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead (< 10ms –Ω–∞ –ø–∞—Ç—á)
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ HTML –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead (< 1ms –Ω–∞ –æ—Ç–≤–µ—Ç)

## Usage Examples
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ª–∞–π—Å–æ–≤
python -m src.slicer

# –ó–∞–ø—É—Å–∫ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
python -m src.itext2kg

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
ls data/out/
# ConceptDictionary.json
# LearningChunkGraph_raw.json

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
cat logs/itext2kg_*.log | grep ERROR

# –ê–Ω–∞–ª–∏–∑ bad responses
ls logs/*_bad.json

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–º–ø–æ–≤
ls logs/*_temp_*.json
# ConceptDictionary_temp_interrupted_20240115_103045.json
# LearningChunkGraph_temp_interrupted_20240115_103045.json
# processing_stats_interrupted_20240115_103045.json
# ConceptDictionary_temp_validation_error_slice_042_20240115_103045.json
```